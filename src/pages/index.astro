---
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const [notas, steam] = await Promise.all([
  getCollection('notas', ({ data }) => import.meta.env.PROD ? !data.draft : true),
  getCollection('steam', ({ data }) => import.meta.env.PROD ? !data.draft : true),
]);

const posts = [...notas, ...steam].sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
);

function fmtFecha(d: Date) {
  return new Intl.DateTimeFormat('es-PA', {
    day: '2-digit',
    month: 'long',
    year: 'numeric',
    timeZone: 'America/Panama',
  }).format(d);
}
---

<Layout>
	<Navbar />

	<div class="content">
		<hr class="line_1">
		
			<h1 class="type">William<span>.Blog</span></h1>
			<p >¬°Hola! Bienvenid@ a mi rinc√≥n en internet. Aqu√≠ voy guardando lo que hago y aprendo en cuatro frentes: üíª Desarrollo web (apuntes pr√°cticos, snippets y mini-gu√≠as), üéÆ Juegos de Steam (rese√±as cortas, rendimiento, mods y progreso), üóíÔ∏è Notas personales (ideas, listas y recordatorios) y ‚öΩ F√∫tbol (an√°lisis de partidos, t√°cticas y apuntes de entreno).</p>
		
		<hr class="line_2">
	</div>

	<div class="post_content">
		<h3>‚åö Publicaciones Recientes</h3>
		<div class="render_post">
			{posts.map((post) => (
				<div id={`${post.collection}-${post.slug}`}>
					<p class="meta"> ‚û°Ô∏é {fmtFecha(post.data.pubDate)} 
						<a class="card" href={`/${post.collection}/${post.slug}/`}>
						{post.data.title}
						</a> 
					</p>
					
				</div>
			))}
		</div>

		<p>Ver todos las <a href="">Publicaciones</a></p>

		<div class="contact_content">
			<h3>üìß Cont√°ctame</h3>
			<p>Si quieres ponerte en contacto conmigo o quieres saber mas sobre este blog, puedes enviarme un correo a <a href="mailto:espinozaw657@gmail.com">espinozaw657@gmail.com</a></p>
			<hr>
			<h3>üìü Sobre el sitio web</h3>
			<p>Si quieres saber mas sobre el sitio web, puedes ver la p√°gina de <a href="/sobre">Sobre el sitio web</a></p>
		</div>
	</div>

	<hr class="line_5">

	<Footer />
</Layout>

<style>
	/* styles of content */
	.content {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		text-align: center;
		margin: 3rem 0;
	}

	.line_1 {
		width: 100%;
		height: 1px;
		border: none;
		border-top: 1px solid #444444;
	}

	.line_2 {
		width: 100%;
		height: 1px;
		border: none;
		border-top: 1px solid #444444;
	}

	h1 {
		font-size: 3.5rem;
		margin: 2rem 0 1rem;
		color: #ffd970;
	}

	p {
		text-align: start;
		line-height: 1.8;
		max-width: max-content;
		margin: 1rem 0 3rem;
	}

	span {
		color: #ffffff;
	}

	.type {
		display: inline-block;
		overflow: hidden;
		border-right: 2px solid #ffffff; 
		white-space: nowrap;
		animation: typing 1.5s steps(30, end) forwards, blink 1.5s step-end infinite;
		width: 0; 
	}

	
	@keyframes typing {
		from { width: 0; }
		to { width: 45%; }
	}

	
	@keyframes blink {
		50% { border-color: transparent; }
	}


	@media (max-width: 768px) {

		h1 {
			font-size: 1.8rem;
		}
		p {
			font-size: 0.85rem;
			margin: 0.8rem 0 1.5rem;
			max-width: 70ch;
		}
	}

	@media (max-width: 480px) {

		h1 {
			font-size: 1.5rem;
		}
		p {
			font-size: 0.8rem;
			margin: 0.5rem 0 1rem;
			max-width: 50ch;
		}
	}


	/* styles of post_content */
	.post_content p, a{
		margin: 0.5rem 0;
	}

	.post_content h3 {
		text-align: start;
		color: #FF7474;
		margin-bottom: 1rem;
	}

	.post_content ul {
		line-height: 1.5;
		max-width: 80ch;
	}

	.post_content p {
		line-height: 1.5;
		max-width: max-content;
	}

	.contact_content {
		margin: 2.5rem 0;
	}

	.contact_content hr {
		margin: 2rem auto;
		border: 2px dotted rgb(139, 139, 139);
		max-width: 110px;
	}

	.line_5 {
		width: 90%;
		margin: 1rem auto;
		border: 2px solid #444444;
	}

	@media (max-width: 768px) {

		.post_content p, ul, li {
			font-size: 0.85rem;
		}
	}

	@media (max-width: 350px) {

		.content p {
			margin-bottom: 3rem;
		}

		.render_post .meta {
			font-size: 0.8rem;
		}

		.render_post .card p{
			font-size: 0.7rem;
		}

		@keyframes typing {
		from { width: 0; }
		to { width: 53%; }
	}

	}

</style>
